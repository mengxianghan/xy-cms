(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1fd63afd"],{"59e3":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-modal",{attrs:{title:e.title,"confirm-loading":e.confirmLoading},on:{ok:e.onOk,cancel:e.onCancel},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[r("a-form",e._b({attrs:{form:e.form}},"a-form",e.formItemLayout,!1),[r("a-form-item",{attrs:{label:"用户名"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["username",{rules:[{required:!0,message:"请输入用户名"}]}],expression:"['username',{rules:[{required:true,message:'请输入用户名'}]}]"}]})],1),r("a-form-item",{attrs:{label:"密码",extra:e.isRequiredPassword?"":"不填写则不修改"}},[r("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:e.isRequiredPassword,message:"请输入密码"},{validator:e.verifyPassword}]}],expression:"['password',{rules:[{required:isRequiredPassword,message:'请输入密码'},{validator:verifyPassword}]}]"}],attrs:{"allow-clear":""}})],1),r("a-form-item",{attrs:{label:"角色"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["role_id",{rules:[{required:!0,message:"请输入选择角色"}]}],expression:"['role_id',{rules:[{required:true,message:'请输入选择角色'}]}]"}],attrs:{mode:"multiple",loading:e.roleLoading,disabled:e.isSuper}},e._l(e.roleList,(function(t){return r("a-select-option",{key:t.id},[e._v(e._s(t.name))])})),1)],1),r("a-form-item",{attrs:{label:"部门"}},[r("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["dept_id"],expression:"['dept_id']"}],attrs:{"tree-data":e.treeData}})],1),r("a-form-item",{attrs:{label:"岗位"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["post_id"],expression:"['post_id']"}],attrs:{loading:e.postLoading}},e._l(e.postList,(function(t){return r("a-select-option",{key:t.id},[e._v(e._s(t.name)+" ")])})),1)],1),r("a-form-item",{attrs:{label:"姓名"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["full_name"],expression:"['full_name']"}]})],1),r("a-form-item",{attrs:{label:"手机"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["mobile"],expression:"['mobile']"}]})],1),r("a-form-item",{attrs:{label:"邮箱"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email"],expression:"['email']"}]})],1),r("a-form-item",{attrs:{label:"状态"}},[r("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["status",{initialValue:"1"}],expression:"['status',{initialValue:'1'}]"}],attrs:{disabled:e.isSuper}},[r("a-radio",{attrs:{value:"1"}},[e._v("正常")]),r("a-radio",{attrs:{value:"0"}},[e._v("禁用")])],1)],1),r("a-form-item",{attrs:{label:"排序"}},[r("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["sort",{initialValue:"99"}],expression:"['sort',{initialValue:'99'}]"}]})],1)],1)],1)},i=[],s=(r("e35a"),r("0d7a"),r("6db4"),r("b449"),r("5d83")),o=r("e49c"),n={mixins:[o["default"]],data:function(){return{roleList:[],roleLoading:!1,postList:[],postLoading:!1,isRequiredPassword:!1}},watch:{visible:function(e){e&&(this.roleList.length||this.getRoleList(),this.postList.length||this.getPostList())}},computed:{treeData:function(){return this.$parent.treeData},isSuper:function(){return"1"===this.record.type}},methods:{verifyPassword:function(e,t,r){t&&t.trim().length<6&&r("密码长度至少6位"),r()},getRoleList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.roleLoading=!0,t.next=3,e.$api.system.role.getList({status:"1",has_pagination:"0"});case 3:r=t.sent,a=r.code,i=r.data.list,e.roleLoading=!1,"200"===a&&(e.roleList=i);case 8:case"end":return t.stop()}}),t)})))()},getPostList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.postLoading=!0,t.next=3,e.$api.system.post.getList({status:"1",has_pagination:"0"});case 3:r=t.sent,a=r.code,i=r.data.list,e.postLoading=!1,"200"===a&&(e.postList=i);case 8:case"end":return t.stop()}}),t)})))()},handleInsert:function(){var e=this;this.toggleModal(),this.title="新增用户",this.$nextTick((function(){var t=e.$parent.deptId.split(",").length?e.$parent.deptId.split(",")[0]:"";e.isRequiredPassword=!0,e.form.setFieldsValue({dept_id:t})}))},handleEdit:function(e){var t=this;this.toggleModal(),this.record=e,this.title="编辑用户",this.$nextTick((function(){t.isRequiredPassword=!1,t.form.setFieldsValue({username:e.username,role_id:e.role_id,dept_id:e.dept_id,post_id:e.post_id,full_name:e.full_name,mobile:e.mobile,email:e.email,status:e.status,sort:e.sort})}))},handleDelete:function(e){var t=this;this.$api.system.user.delete({id:e.id}).then((function(r){var a=r.code;"200"===a&&(t.$emit("delete",e),t.$emit("complete",e))}))},onOk:function(){var e=this;this.form.validateFieldsAndScroll((function(t,r){t||(e.confirmLoading=!0,e.$api.system.user.submit({id:e.record.id,username:r.username,password:r.password,role_id:r.role_id,dept_id:r.dept_id,post_id:r.post_id,full_name:r.full_name,mobile:r.mobile,email:r.email,status:r.status,sort:r.sort}).then((function(t){var a=t.code;e.confirmLoading=!1,"200"===a&&(e.reset(),e.toggleModal(),e.$emit("ok",r),e.$emit("complete",r))}),(function(t){e.confirmLoading=!1})))}))},onCancel:function(){this.reset(),this.toggleModal(),this.$emit("cancel")}}},l=n,d=r("4023"),u=Object(d["a"])(l,a,i,!1,null,"8279f5ac",null);t["default"]=u.exports},"6db4":function(e,t,r){"use strict";var a=r("1c8b"),i=r("c10f").trim,s=r("f221");a({target:"String",proto:!0,forced:s("trim")},{trim:function(){return i(this)}})},f221:function(e,t,r){var a=r("efe2"),i=r("fc8cf"),s="​᠎";e.exports=function(e){return a((function(){return!!i[e]()||s[e]()!=s||i[e].name!==e}))}}}]);