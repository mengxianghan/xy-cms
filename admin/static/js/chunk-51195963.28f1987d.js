(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-51195963","chunk-2d208333","chunk-2d0b15b5"],{"046a":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("a-row",{attrs:{gutter:16}},[i("a-col",{attrs:{md:5,xs:24}},[i("a-card",{attrs:{bordered:!1}},[i("a-spin",{attrs:{spinning:e.dictDirLoading}},[i("div",[e.treeData.length?i("a-tree",{attrs:{"tree-data":e.treeData,"default-expand-all":""},on:{select:e.handleSelect},scopedSlots:e._u([{key:"title",fn:function(t){var a=t.key,r=t.value,n=t.dirKey,s=t.parentId,o=t.sort;return[i("a-dropdown",{attrs:{trigger:["contextmenu"]}},[i("span",[e._v(e._s(r))]),i("a-menu",{attrs:{slot:"overlay"},on:{click:function(t){return e.handleDirClick({id:a,name:r,key:n,parent_id:s,sort:o},t)}},slot:"overlay"},[i("a-menu-item",{directives:[{name:"action",rawName:"v-action:insert",arg:"insert"}],key:"insert"},[e._v("新增同级 ")]),i("a-menu-item",{directives:[{name:"action",rawName:"v-action:insertNext",arg:"insertNext"}],key:"insertNext"},[e._v("新增下级 ")]),i("a-menu-item",{directives:[{name:"action",rawName:"v-action:edit",arg:"edit"}],key:"edit"},[e._v("编辑 ")]),i("a-menu-divider"),i("a-menu-item",{directives:[{name:"action",rawName:"v-action:delete",arg:"delete"}],key:"delete"},[i("span",{staticStyle:{color:"#ff4d4f"}},[e._v("删除")])])],1)],1)]}}],null,!1,4271125295)}):i("a-button",{attrs:{block:""},on:{click:function(t){return e.$refs.dictDirForm.handleInsert()}}},[e._v("新增字典目录")])],1)])],1)],1),i("a-col",{attrs:{md:19,xs:24}},[i("a-card",{attrs:{bordered:!1}},[i("div",{directives:[{name:"action",rawName:"v-action:insert",arg:"insert"}],staticClass:"mb-2"},[i("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.$refs.editForm.handleInsert()}}},[e._v("新增字典")])],1),i("a-table",{attrs:{columns:e.columns,"data-source":e.list,pagination:e.pagination,loading:e.loading,"row-key":"id",size:"middle"},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"status",fn:function(e){return[i("x-status",{attrs:{code:e}})]}},{key:"operation",fn:function(t,a){return[i("span",{directives:[{name:"action",rawName:"v-action:edit",arg:"edit"}]},[i("a",{on:{click:function(t){return e.$refs.editForm.handleEdit(a)}}},[e._v("编辑")]),i("a-divider",{attrs:{type:"vertical"}})],1),i("span",{directives:[{name:"action",rawName:"v-action:delete",arg:"delete"}]},[i("a-popconfirm",{attrs:{title:"确认删除此数据?"},on:{confirm:function(t){return e.$refs.editForm.handleDelete(a)}}},[i("a",[e._v("删除")])])],1)]}}])})],1)],1)],1),i("edit-form",{ref:"editForm",on:{complete:e.onComplete}}),i("dict-dir-form",{ref:"dictDirForm",on:{ok:e.onDictDirOk,delete:e.onDictDirDelete}})],1)},r=[],n=(i("9302"),i("513c"),i("80a0")),s=i("2001"),o=i("a47a"),d=[{title:"名称",dataIndex:"name"},{title:"Key",dataIndex:"key"},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],c={name:"index",components:{EditForm:s["default"],DictDirForm:o["default"]},data:function(){return{columns:d,list:[],pagination:{showSizeChanger:!0},loading:!1,dictDirList:[],dictDirLoading:!1,dictDirId:""}},created:function(){this.getDictDirList(),this.getList()},computed:{treeData:function(){return this.$xy.util.changeKeys(this.dictDirList,{key:"id",value:"name",dirKey:"key",parentId:"parent_id",sort:"sort",children:"children"},{scopedSlots:{title:"title"}})}},methods:{getList:function(){var e=this;this.loading=!0,this.$api.system.dict.getList({current_page:this.pagination.current,page_size:this.pagination.pageSize,dict_dir_id:this.dictDirId}).then((function(t){var i=t.code,a=t.data,r=a.list,s=a.total;e.loading=!1,"200"===i&&(e.pagination=Object(n["a"])(Object(n["a"])({},e.pagination),{},{total:Number(s)}),e.list=r)})).catch((function(){e.loading=!1}))},getDictDirList:function(){var e=this;this.dictDirLoading=!0,this.$api.system.dictDir.getList({status:"1"}).then((function(t){var i=t.code,a=t.data.list;e.dictDirLoading=!1,"200"===i&&(e.dictDirList=a)}))},handleTableChange:function(e){this.pagination=Object(n["a"])(Object(n["a"])({},this.pagination),{},{current:e.current,pageSize:e.pageSize}),this.getList()},handleDelete:function(e){var t=this;this.$api.system.dict.delete({id:e.id}).then((function(e){var i=e.code;"200"===i&&t.getList()}))},handleSelect:function(e){this.dictDirId=this.$xy.util.getFieldsValue(this.treeData,{parentField:"parentId",parentId:e[0]||"",field:"key"}).join(","),this.getList()},handleDirClick:function(e,t){var i=this;switch(t.key){case"insert":this.$refs.dictDirForm.handleInsert(e);break;case"insertNext":this.$refs.dictDirForm.handleInsertNext(e);break;case"edit":this.$refs.dictDirForm.handleEdit(e);break;case"delete":this.$confirm({title:"确认删除此数据?",onOk:function(){i.$refs.dictDirForm.handleDelete(e)},onCancel:function(){}});break}},onComplete:function(){this.getList()},onDictDirOk:function(){this.getDictDirList()},onDictDirDelete:function(e){this.getDictDirList(),this.dictDirId===e.id&&(this.dictDirId="",this.getList())}}},l=c,u=i("4023"),m=Object(u["a"])(l,a,r,!1,null,"08829c04",null);t["default"]=m.exports},2001:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-modal",{attrs:{title:e.title,"confirm-loading":e.confirmLoading},on:{ok:e.onOk,cancel:e.onCancel},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[i("a-form",e._b({attrs:{form:e.form}},"a-form",e.formItemLayout,!1),[i("a-form-item",{attrs:{label:"所属目录"}},[i("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["dict_dir_id",{rules:[{required:!0,message:"请选择所属目录"}]}],expression:"['dict_dir_id',{rules:[{required:true,message:'请选择所属目录'}]}]"}],attrs:{"tree-data":e.treeData,"default-expand-all":""}})],1),i("a-form-item",{attrs:{label:"字典名称"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入字典名称"}]}],expression:"['name',{rules:[{required:true,message:'请输入字典名称'}]}]"}]})],1),i("a-form-item",{attrs:{label:"Key"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["key",{rules:[{required:!0,message:"请输入Key"}]}],expression:"['key',{rules:[{required:true,message:'请输入Key'}]}]"}]})],1),i("a-form-item",{attrs:{label:"备注"}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark"],expression:"['remark']"}]})],1),i("a-form-item",{attrs:{label:"状态"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["status",{initialValue:"1"}],expression:"['status',{initialValue:'1'}]"}]},[i("a-radio",{attrs:{value:"1"}},[e._v("正常")]),i("a-radio",{attrs:{value:"0"}},[e._v("禁用")])],1)],1),i("a-form-item",{attrs:{label:"排序"}},[i("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["sort",{initialValue:"99"}],expression:"['sort',{initialValue:'99'}]"}]})],1)],1)],1)},r=[],n=(i("dbb3"),i("053b"),i("e35a"),i("0d7a"),i("e49c")),s={mixins:[n["default"]],data:function(){return{dictDirKey:""}},created:function(){var e=this;this.form=this.$form.createForm(this,{onValuesChange:function(t,i){if(i.dict_dir_id){var a=e.$xy.util.treeToList(e.$parent.dictDirList).filter((function(e){return e.id===i.dict_dir_id}));a.length?e.dictDirKey=a[0].key:e.dictDirKey=""}}})},computed:{treeData:function(){return this.$xy.util.changeKeys(this.$parent.dictDirList)}},methods:{handleInsert:function(){var e=this;if(0===this.$parent.dictDirList.length)return this.$message.warn("请添加字典目录"),!1;this.toggleModal(),this.title="新增字典",this.$nextTick((function(){var t=e.$parent.dictDirId.split(",").length?e.$parent.dictDirId.split(",")[0]:"";e.form.setFieldsValue({dict_dir_id:t})}))},handleEdit:function(e){var t=this;this.toggleModal(),this.record=e,this.title="编辑字典",this.dictDirKey=e.dict_dir_key,this.$nextTick((function(){t.form.setFieldsValue({dict_dir_id:e.dict_dir_id,name:e.name,key:e.key,remark:e.remark,status:e.status,sort:e.sort})}))},handleDelete:function(e){var t=this;this.$api.system.dict.delete({id:e.id}).then((function(i){var a=i.code;"200"===a&&(t.$emit("delete",e),t.$emit("complete",e))}))},onOk:function(){var e=this;this.form.validateFieldsAndScroll((function(t,i){t||(e.confirmLoading=!0,e.$api.system.dict.submit({id:e.record.id,dict_dir_id:i.dict_dir_id,dict_dir_key:e.dictDirKey,name:i.name,key:i.key,remark:i.remark,status:i.status,sort:i.sort}).then((function(t){var a=t.code;e.confirmLoading=!1,"200"===a&&(e.reset(),e.toggleModal(),e.$emit("ok",i),e.$emit("complete",i))}),(function(t){e.confirmLoading=!1})))}))},onCancel:function(){this.reset(),this.toggleModal(),this.$emit("cancel")}}},o=s,d=i("4023"),c=Object(d["a"])(o,a,r,!1,null,"0e5667d5",null);t["default"]=c.exports},a47a:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-modal",{attrs:{title:e.title,"confirm-loading":e.confirmLoading},on:{ok:e.onOk,cancel:e.onCancel},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[i("a-form",e._b({attrs:{form:e.form}},"a-form",e.formItemLayout,!1),[i("a-form-item",{attrs:{label:"上级目录"}},[i("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["parent_id",{rules:[{required:!0,message:"请选择上级目录"}]}],expression:"['parent_id',{rules:[{required:true,message:'请选择上级目录'}]}]"}],attrs:{"tree-data":e.treeData}})],1),i("a-form-item",{attrs:{label:"名称"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入名称"}]}],expression:"['name',{rules:[{required:true,message:'请输入名称'}]}]"}]})],1),i("a-form-item",{attrs:{label:"Key"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["key",{rules:[{required:!0,message:"请输入Key"}]}],expression:"['key',{rules:[{required:true,message:'请输入Key'}]}]"}]})],1),i("a-form-item",{attrs:{label:"排序"}},[i("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["sort",{initialValue:"99"}],expression:"['sort',{initialValue:'99'}]"}]})],1)],1)],1)},r=[],n=(i("b4fb"),i("b130"),i("053b"),i("fe8a"),i("90aa"),i("5c62")),s=i("e49c"),o={mixins:[s["default"]],data:function(){return{}},created:function(){},computed:{disabledId:function(){return this.$xy.util.getFieldsValue(this.$parent.list,{parentId:this.record.id})},treeData:function(){var e=this;return[{title:"无",value:"0",key:"0"}].concat(Object(n["a"])(this.$xy.util.changeKeys(this.$parent.dictDirList,{title:"name",value:"id",key:"id",children:"children",disabled:function(t){return e.disabledId.includes(t.id)}})))}},methods:{handleInsert:function(e){var t=this;this.toggleModal(),this.title="新增字典目录",this.$nextTick((function(){t.form.setFieldsValue({parent_id:e?e.parent_id:"0"})}))},handleInsertNext:function(e){var t=this;this.toggleModal(),this.title="新增下级",this.$nextTick((function(){t.form.setFieldsValue({parent_id:e.id})}))},handleEdit:function(e){var t=this;this.toggleModal(),this.record=e,this.title="编辑字典目录",this.$nextTick((function(){t.form.setFieldsValue({parent_id:e.parent_id,name:e.name,key:e.key,sort:e.sort})}))},handleDelete:function(e){var t=this;this.$api.system.dictDir.delete({id:e.id}).then((function(i){var a=i.code;"200"===a&&(t.$emit("delete",e),t.$emit("complete",e))}))},onOk:function(){var e=this;this.form.validateFieldsAndScroll((function(t,i){if(!t){var a=Object.keys(e.record).length&&i.key!==e.record.key?"1":"0";e.confirmLoading=!0,e.$api.system.dictDir.submit({id:e.record.id,parent_id:i.parent_id,name:i.name,key:i.key,is_update_dir_key:a,sort:i.sort}).then((function(t){var a=t.code;e.confirmLoading=!1,"200"===a&&(e.reset(),e.toggleModal(),e.$emit("ok",i),e.$emit("complete",i))}),(function(t){e.confirmLoading=!1}))}}))},onCancel:function(){this.reset(),this.toggleModal(),this.$emit("cancel")}}},d=o,c=i("4023"),l=Object(c["a"])(d,a,r,!1,null,"78295d5c",null);t["default"]=l.exports}}]);