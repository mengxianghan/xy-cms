(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c1673b3"],{9092:function(t,e,n){},e25f:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-modal",{attrs:{title:t.title,"confirm-loading":t.confirmLoading,width:"640px"},on:{ok:t.onOk,cancel:t.onCancel},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[n("a-spin",{attrs:{spinning:t.spinning}},[t.list.length?n("a-tree",{staticClass:"auth-tree",attrs:{"tree-data":t.list,"default-expand-all":"",checkable:"","check-strictly":!1},on:{check:t.onCheck},model:{value:t.checkedKeys,callback:function(e){t.checkedKeys=e},expression:"checkedKeys"}}):t._e()],1)],1)},a=[],c=(n("b4fb"),n("fe59"),n("2eeb"),n("513c"),n("e35a"),n("0d7a"),n("08ba"),n("5c62")),s=(n("b449"),n("5d83")),r=n("e49c"),o=void 0,l=function t(e){return o.$xy.util.changeKeys(e,{title:"name",value:"id",key:"id",children:function(e){if(e.children&&e.children.length)return t(e.children);if(e.auth_id){var n=e.auth_id.split(","),i=e.auth_name.split(",");return i.map((function(t,i){return{class:"last-tree-node",title:t,value:"".concat(e.id,",").concat(n[i]),key:"".concat(e.id,",").concat(n[i])}}))}}})},h={props:{type:{type:[Number,String],default:1}},mixins:[r["default"]],data:function(){return{list:[],spinning:!1,checkedKeys:[],halfCheckedKeys:[]}},created:function(){this.title="设置权限"},watch:{visible:function(t){t&&!this.list.length&&this.getMenuList()}},methods:{getMenuList:function(){var t=this;this.spinning=!0;var e=this.$ls.get("userInfo"),n=e.id;this.$api.system.auth.getMenuList({id:n,type:"2"}).then((function(e){var n=e.code,i=e.data.list;t.spinning=!1,"200"===n&&(t.list=l(i))}))},getAlreadyAuthList:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,i,a,c,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.spinning=!0,e.next=3,t.$api.system.auth.getAlreadyAuthList({id:t.record.id,type:t.type});case 3:n=e.sent,i=n.code,a=n.data.list,t.spinning=!1,"200"===i&&(c=[],s=[],a.forEach((function(t){s.push(t.menu_id),t.auth_button_id&&t.auth_button_id.split(",").forEach((function(e){c.push("".concat(t.menu_id,",").concat(e))}))})),t.checkedKeys=c,t.halfCheckedKeys=s);case 8:case"end":return e.stop()}}),e)})))()},handleEdit:function(t){this.toggleModal(),this.record=t,this.getAlreadyAuthList()},onCheck:function(t,e){var n=e.halfCheckedKeys;this.halfCheckedKeys=n},onOk:function(){var t=this;this.confirmLoading=!0;var e=[].concat(Object(c["a"])(this.formatValues(this.checkedKeys)),Object(c["a"])(this.formatValues(this.halfCheckedKeys,"1")));this.$api.system.auth.submit({id:this.record.id,type:this.type,values:e}).then((function(e){var n=e.code;t.confirmLoading=!1,"200"===n&&(t.reset(),t.toggleModal(),t.$emit("ok"),t.$emit("complete"))}))},onCancel:function(){this.reset(),this.toggleModal(),this.$emit("cancel")},formatValues:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0",i=t.map((function(t){var i=t.split(","),a=2==i.length?i[0]:t,c=2==i.length?i[1]:"";return{id:e.record.id,type:e.type,menu_id:a,auth_button_id:c,is_half:n}}));return i}}},u=h,d=(n("fa9f"),n("4023")),f=Object(d["a"])(u,i,a,!1,null,"1b92e9d4",null);e["default"]=f.exports},fa9f:function(t,e,n){"use strict";var i=n("9092"),a=n.n(i);a.a}}]);